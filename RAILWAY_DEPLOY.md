# ğŸš‚ Railway éƒ¨ç½²æŒ‡å—

## ğŸ“‹ å‰ç½®è¦æ±‚

1. **GitHub å¸³è™Ÿ**ï¼ˆå·²é€£æ¥ä½ çš„å°ˆæ¡ˆï¼‰
2. **Railway å¸³è™Ÿ**ï¼ˆå…è²»è¨»å†Šï¼Œ**ç„¡éœ€ä¿¡ç”¨å¡**ï¼‰
3. **Git LFS**ï¼ˆç”¨æ–¼ç®¡ç†æ¨¡å‹æª”æ¡ˆï¼‰

---

## ğŸ¯ å¿«é€Ÿéƒ¨ç½²æ­¥é©Ÿï¼ˆ5 åˆ†é˜ï¼‰

### æ­¥é©Ÿ 1ï¼šç¢ºä¿æª”æ¡ˆå·²æ¨é€åˆ° GitHub

```bash
git add railway.json RAILWAY_DEPLOY.md
git commit -m "æ·»åŠ  Railway éƒ¨ç½²é…ç½®"
git push origin main
```

### æ­¥é©Ÿ 2ï¼šåœ¨ Railway å‰µå»ºå°ˆæ¡ˆ

1. è¨ªå• https://railway.app
2. é»æ“Š **"Start a New Project"**
3. é¸æ“‡ **"Deploy from GitHub repo"**
4. æˆæ¬Š Railway è¨ªå•ä½ çš„ GitHub
5. é¸æ“‡ä½ çš„å€‰åº« `butterfly-bird-identifier`

### æ­¥é©Ÿ 3ï¼šé…ç½®æœå‹™

Railway æœƒè‡ªå‹•æª¢æ¸¬ä½ çš„å°ˆæ¡ˆï¼Œä½†éœ€è¦æ‰‹å‹•é…ç½®ï¼š

#### 3.1 è¨­ç½®æ ¹ç›®éŒ„

1. åœ¨æœå‹™è¨­ç½®ä¸­ï¼Œæ‰¾åˆ° **"Root Directory"**
2. è¨­ç½®ç‚ºï¼š`web_app/backend`

#### 3.2 è¨­ç½®ç’°å¢ƒè®Šæ•¸

åœ¨ **"Variables"** æ¨™ç±¤ä¸­æ·»åŠ ï¼š

| è®Šæ•¸åç¨± | å€¼ | èªªæ˜ |
|---------|-----|------|
| `FLASK_ENV` | `production` | ç”Ÿç”¢ç’°å¢ƒæ¨¡å¼ |
| `PORT` | `è‡ªå‹•è¨­ç½®` | Railway æœƒè‡ªå‹•è¨­ç½®ï¼Œç„¡éœ€æ‰‹å‹•é…ç½® |
| `PYTHON_VERSION` | `3.11.0` | Python ç‰ˆæœ¬ï¼ˆå¯é¸ï¼‰|

#### 3.3 è¨­ç½®æ§‹å»ºå‘½ä»¤ï¼ˆå¦‚æœéœ€è¦ï¼‰

å¦‚æœè‡ªå‹•æª¢æ¸¬å¤±æ•—ï¼Œåœ¨ **"Settings"** â†’ **"Build Command"** ä¸­è¨­ç½®ï¼š

```bash
git lfs install && git lfs pull && cd web_app/backend && pip install --upgrade pip && pip install -r requirements.txt
```

#### 3.4 è¨­ç½®å•Ÿå‹•å‘½ä»¤

åœ¨ **"Settings"** â†’ **"Start Command"** ä¸­è¨­ç½®ï¼š

```bash
cd web_app/backend && python app.py
```

### æ­¥é©Ÿ 4ï¼šç­‰å¾…éƒ¨ç½²å®Œæˆ

- é¦–æ¬¡éƒ¨ç½²å¯èƒ½éœ€è¦ 5-10 åˆ†é˜
- Railway æœƒè‡ªå‹•ï¼š
  - å®‰è£ Git LFS
  - ä¸‹è¼‰æ¨¡å‹æª”æ¡ˆ
  - å®‰è£ Python ä¾è³´
  - å•Ÿå‹•æ‡‰ç”¨

### æ­¥é©Ÿ 5ï¼šç²å–æœå‹™ URL

éƒ¨ç½²å®Œæˆå¾Œï¼š
1. é»æ“Šæœå‹™
2. åœ¨ **"Settings"** â†’ **"Networking"** ä¸­
3. é»æ“Š **"Generate Domain"** ç”Ÿæˆå…¬é–‹ URL
4. æˆ–ä½¿ç”¨ Railway è‡ªå‹•ç”Ÿæˆçš„ URLï¼ˆæ ¼å¼ï¼š`xxx.railway.app`ï¼‰

---

## âš™ï¸ é‡è¦é…ç½®èªªæ˜

### 1. Git LFS æ”¯æ´

æ¨¡å‹æª”æ¡ˆï¼ˆ`model.h5`ï¼‰é€šé Git LFS ç®¡ç†ï¼Œéœ€è¦åœ¨æ§‹å»ºæ™‚ä¸‹è¼‰ã€‚

**æ–¹æ³•ä¸€ï¼šåœ¨æ§‹å»ºå‘½ä»¤ä¸­åŒ…å«**
```bash
git lfs install && git lfs pull && cd web_app/backend && pip install -r requirements.txt
```

**æ–¹æ³•äºŒï¼šä½¿ç”¨ Railway çš„ç’°å¢ƒè®Šæ•¸**
- æ·»åŠ ç’°å¢ƒè®Šæ•¸ï¼š`GIT_LFS_SKIP_SMUDGE` = `0`

### 2. ç«¯å£é…ç½®

Railway ä½¿ç”¨ç’°å¢ƒè®Šæ•¸ `PORT`ï¼Œä½ çš„ `app.py` å·²ç¶“æ”¯æ´ï¼š

```python
port = int(os.environ.get('PORT', 5000))
```

Railway æœƒè‡ªå‹•è¨­ç½® `PORT`ï¼Œç„¡éœ€æ‰‹å‹•é…ç½®ã€‚

### 3. æª”æ¡ˆè·¯å¾‘

ç¢ºä¿ç¨‹å¼ç¢¼ä¸­çš„è·¯å¾‘æ˜¯ç›¸å°æ–¼å°ˆæ¡ˆæ ¹ç›®éŒ„çš„ï¼š

```python
# app.py ä¸­å·²ç¶“æ­£ç¢ºè™•ç†äº†è·¯å¾‘
base_dir = os.path.dirname(os.path.dirname(os.path.dirname(current_file)))
```

---

## ğŸ” éƒ¨ç½²å¾Œæª¢æŸ¥

### 1. æª¢æŸ¥æœå‹™ç‹€æ…‹

åœ¨ Railway Dashboard ä¸­ï¼Œç¢ºèªæœå‹™ç‹€æ…‹ç‚º **"Active"**

### 2. æ¸¬è©¦ API

è¨ªå•ä½ çš„æœå‹™ URLï¼ˆä¾‹å¦‚ï¼š`https://xxx.railway.app`ï¼‰

æ‡‰è©²çœ‹åˆ°ï¼š
```json
{
  "status": "success",
  "message": "Butterfly and Bird Identification API is running",
  "model_loaded": true
}
```

### 3. æ¸¬è©¦è­˜åˆ¥åŠŸèƒ½

ä½¿ç”¨ Postman æˆ– curl æ¸¬è©¦ï¼š

```bash
curl -X POST https://your-app.railway.app/api/predict \
  -F "image=@test_image.jpg"
```

---

## âš ï¸ å¸¸è¦‹å•é¡Œ

### Q1: éƒ¨ç½²å¤±æ•—ï¼Œæç¤º "Git LFS pull failed"

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. ç¢ºä¿ GitHub å€‰åº«ä¸­æ¨¡å‹æª”æ¡ˆå·²é€šé Git LFS ä¸Šå‚³
2. æª¢æŸ¥ `.gitattributes` æª”æ¡ˆæ˜¯å¦æ­£ç¢ºé…ç½®
3. åœ¨æ§‹å»ºå‘½ä»¤ä¸­æ˜ç¢ºåŒ…å« `git lfs install && git lfs pull`

### Q2: æ¨¡å‹æª”æ¡ˆæœªè¼‰å…¥

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. æª¢æŸ¥æ§‹å»ºæ—¥èªŒï¼Œç¢ºèª `git lfs pull` æˆåŠŸåŸ·è¡Œ
2. æª¢æŸ¥æ¨¡å‹æª”æ¡ˆè·¯å¾‘æ˜¯å¦æ­£ç¢º
3. æŸ¥çœ‹æ‡‰ç”¨æ—¥èªŒç¢ºèªæ¨¡å‹è¼‰å…¥ç‹€æ…‹

### Q3: æ‡‰ç”¨å•Ÿå‹•å¾Œç«‹å³åœæ­¢

**è§£æ±ºæ–¹æ¡ˆï¼š**
1. æª¢æŸ¥ `startCommand` æ˜¯å¦æ­£ç¢º
2. ç¢ºèªæ ¹ç›®éŒ„è¨­ç½®ç‚º `web_app/backend`
3. æŸ¥çœ‹æ—¥èªŒæ‰¾å‡ºéŒ¯èª¤åŸå› 

### Q4: ç«¯å£éŒ¯èª¤

**è§£æ±ºæ–¹æ¡ˆï¼š**
- Railway æœƒè‡ªå‹•è¨­ç½® `PORT` ç’°å¢ƒè®Šæ•¸
- ç¢ºä¿ `app.py` ä½¿ç”¨ `os.environ.get('PORT', 5000)`
- ä¸è¦æ‰‹å‹•è¨­ç½® `PORT` ç’°å¢ƒè®Šæ•¸

---

## ğŸ“Š ç›£æ§å’Œç¶­è­·

### 1. æŸ¥çœ‹æ—¥èªŒ

åœ¨ Railway Dashboard ä¸­ï¼š
- é»æ“Šä½ çš„æœå‹™
- é¸æ“‡ **"Deployments"** æ¨™ç±¤
- é»æ“Šæœ€æ–°çš„éƒ¨ç½²ï¼ŒæŸ¥çœ‹ **"Logs"**

### 2. è¨­ç½®ç’°å¢ƒè®Šæ•¸

åœ¨ Railway Dashboard ä¸­ï¼š
- é»æ“Šä½ çš„æœå‹™
- é¸æ“‡ **"Variables"** æ¨™ç±¤
- æ·»åŠ æˆ–ä¿®æ”¹ç’°å¢ƒè®Šæ•¸

### 3. é‡æ–°éƒ¨ç½²

å¦‚æœéœ€è¦é‡æ–°éƒ¨ç½²ï¼š
- åœ¨æœå‹™é é¢é»æ“Š **"Redeploy"**
- æˆ–æ¨é€æ–°çš„ commit åˆ° GitHubï¼ˆè‡ªå‹•è§¸ç™¼éƒ¨ç½²ï¼‰

---

## ğŸ”— é€£æ¥å‰ç«¯

éƒ¨ç½²å¾Œç«¯å¾Œï¼Œéœ€è¦æ›´æ–°å‰ç«¯çš„ API URLï¼š

### å¦‚æœå‰ç«¯éƒ¨ç½²åœ¨ Vercelï¼š

1. åœ¨ Vercel Dashboard ä¸­
2. é€²å…¥å°ˆæ¡ˆè¨­ç½® â†’ Environment Variables
3. æ·»åŠ /æ›´æ–°ï¼š
   - `REACT_APP_API_URL` = `https://your-app.railway.app`

### å¦‚æœå‰ç«¯éƒ¨ç½²åœ¨ Netlifyï¼š

1. åœ¨ Netlify Dashboard ä¸­
2. é€²å…¥ Site settings â†’ Environment variables
3. æ·»åŠ /æ›´æ–°ï¼š
   - `REACT_APP_API_URL` = `https://your-app.railway.app`

---

## ğŸ’° è²»ç”¨èªªæ˜

### å…è²»å¥—é¤é™åˆ¶ï¼š

- âœ… æ¯æœˆ $5 å…è²»é¡åº¦
- âœ… 512MB RAM
- âœ… 1GB ç£ç¢Ÿç©ºé–“
- âœ… ç„¡ä¼‘çœ æ©Ÿåˆ¶
- âœ… ç„¡éœ€ä¿¡ç”¨å¡

### ä½¿ç”¨é‡ç›£æ§ï¼š

- åœ¨ Railway Dashboard å¯ä»¥æŸ¥çœ‹ä½¿ç”¨é‡
- å¦‚æœæ¥è¿‘ $5 é™åˆ¶ï¼Œæœƒæ”¶åˆ°é€šçŸ¥
- è¶…éå¾Œå¯ä»¥å‡ç´šæˆ–ç­‰å¾…ä¸‹å€‹æœˆé‡ç½®

---

## âœ… éƒ¨ç½²æª¢æŸ¥æ¸…å–®

- [ ] GitHub å€‰åº«å·²é€£æ¥
- [ ] `railway.json` å·²å‰µå»ºä¸¦æ¨é€
- [ ] Railway å°ˆæ¡ˆå·²å‰µå»º
- [ ] æ ¹ç›®éŒ„è¨­ç½®ç‚º `web_app/backend`
- [ ] ç’°å¢ƒè®Šæ•¸å·²æ­£ç¢ºè¨­ç½®
- [ ] æ§‹å»ºå‘½ä»¤åŒ…å« Git LFS
- [ ] æ§‹å»ºæˆåŠŸå®Œæˆ
- [ ] API æ¸¬è©¦é€šé
- [ ] æ¨¡å‹æª”æ¡ˆå·²æ­£ç¢ºè¼‰å…¥
- [ ] å‰ç«¯ API URL å·²æ›´æ–°

---

## ğŸ‰ å®Œæˆï¼

éƒ¨ç½²å®Œæˆå¾Œï¼Œä½ çš„ API å°±å¯ä»¥ä½¿ç”¨äº†ï¼

**API URL ç¯„ä¾‹ï¼š**
```
https://butterfly-bird-api.railway.app
```

**å¥åº·æª¢æŸ¥ï¼š**
```
https://butterfly-bird-api.railway.app/
```

---

## ğŸ“ éœ€è¦å¹«åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°å•é¡Œï¼š
1. æŸ¥çœ‹ Railway Dashboard çš„æ—¥èªŒ
2. æª¢æŸ¥ GitHub Actionsï¼ˆå¦‚æœæœ‰ï¼‰
3. åƒè€ƒ Railway å®˜æ–¹æ–‡æª”ï¼šhttps://docs.railway.app

ç¥éƒ¨ç½²é †åˆ©ï¼ğŸš€

---

## ğŸ†š Railway vs Koyeb å°æ¯”

| ç‰¹æ€§ | Railway | Koyeb |
|------|---------|-------|
| å…è²»é¡åº¦ | $5/æœˆ | æœ‰é™ |
| ä¼‘çœ æ©Ÿåˆ¶ | âŒ ç„¡ | âš ï¸ 7 å¤©æœªæ´»å‹•å¯èƒ½æš«åœ |
| éœ€è¦ä¿¡ç”¨å¡ | âŒ ä¸éœ€è¦ | âŒ ä¸éœ€è¦ |
| ç©©å®šæ€§ | â­â­â­â­â­ | â­â­â­ |
| é©åˆä½œæ¥­æ¼”ç¤º | âœ… éå¸¸é©åˆ | âš ï¸ éœ€è¦ä¿æŒæ´»èº |

**çµè«–ï¼šRailway æ›´é©åˆä½ çš„ä½œæ¥­éœ€æ±‚ï¼**

